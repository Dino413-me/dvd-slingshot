<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>DVD Bounce Launcher</title>
<style>
    body {
        background: #111;
        color: white;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
    }

    #container {
        width: 600px;
        height: 400px;
        border: 3px solid white;
        position: relative;
        overflow: hidden;
        background: #000;
        cursor: crosshair;
    }

    #dvd {
        width: 80px;
        height: 40px;
        background: #0ff;
        position: absolute;
        left: 260px;
        top: 180px;
        border-radius: 8px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        user-select: none;
    }

    #ui {
        margin-top: 15px;
        display: flex;
        gap: 20px;
        align-items: center;
    }

    select {
        font-size: 16px;
        padding: 4px 8px;
    }
</style>
</head>
<body>

<h2>DVD Bounce Launcher</h2>

<div id="container">
    <div id="dvd">DVD</div>
</div>

<div id="ui">
    <div>Bounces: <span id="bounceCount">0</span></div>

    <label>Speed:
        <select id="speedSelect">
            <option value="0.25">0.25x</option>
            <option value="0.5">0.5x</option>
            <option value="1" selected>1x</option>
            <option value="1.5">1.5x</option>
            <option value="2">2x</option>
            <option value="5">5x</option>
            <option value="instant">Instant</option>
        </select>
    </label>
</div>

<script>
const dvd = document.getElementById("dvd");
const container = document.getElementById("container");
const bounceCountEl = document.getElementById("bounceCount");
const speedSelect = document.getElementById("speedSelect");

let dragging = false;
let offsetX = 0, offsetY = 0;
let vx = 0, vy = 0;
let bounceCount = 0;
let animating = false;

// Drag to aim
dvd.addEventListener("mousedown", e => {
    dragging = true;
    animating = false;
    vx = vy = 0;
    bounceCount = 0;
    bounceCountEl.textContent = 0;

    offsetX = e.clientX - dvd.offsetLeft;
    offsetY = e.clientY - dvd.offsetTop;
});

document.addEventListener("mousemove", e => {
    if (!dragging) return;
    dvd.style.left = (e.clientX - offsetX) + "px";
    dvd.style.top = (e.clientY - offsetY) + "px";
});

document.addEventListener("mouseup", e => {
    if (!dragging) return;
    dragging = false;

    // Launch velocity based on pull distance
    const dx = dvd.offsetLeft - 260;
    const dy = dvd.offsetTop - 180;

    vx = dx * 0.15;
    vy = dy * 0.15;

    const speed = speedSelect.value;

    if (speed === "instant") {
        runInstant(dx, dy);
    } else {
        vx *= speed;
        vy *= speed;
        animating = true;
        requestAnimationFrame(update);
    }
});

// Instant mode: mathematically compute corner hit
function runInstant(dx, dy) {
    let x = dvd.offsetLeft;
    let y = dvd.offsetTop;
    let w = container.clientWidth - dvd.clientWidth;
    let h = container.clientHeight - dvd.clientHeight;

    let vx = dx * 0.15;
    let vy = dy * 0.15;

    let bounces = 0;

    while (true) {
        let tx = vx > 0 ? (w - x) / vx : (0 - x) / vx;
        let ty = vy > 0 ? (h - y) / vy : (0 - y) / vy;

        let t = Math.min(tx, ty);

        x += vx * t;
        y += vy * t;

        if (Math.abs(x) < 1 || Math.abs(x - w) < 1) vx *= -1, bounces++;
        if (Math.abs(y) < 1 || Math.abs(y - h) < 1) vy *= -1, bounces++;

        if ((Math.abs(x) < 1 || Math.abs(x - w) < 1) &&
            (Math.abs(y) < 1 || Math.abs(y - h) < 1)) break;
    }

    bounceCountEl.textContent = bounces;
}

// Animation loop
function update() {
    if (!animating) return;

    let x = dvd.offsetLeft + vx;
    let y = dvd.offsetTop + vy;

    const maxX = container.clientWidth - dvd.clientWidth;
    const maxY = container.clientHeight - dvd.clientHeight;

    if (x <= 0 || x >= maxX) {
        vx *= -1;
        bounceCount++;
    }
    if (y <= 0 || y >= maxY) {
        vy *= -1;
        bounceCount++;
    }

    bounceCountEl.textContent = bounceCount;

    dvd.style.left = Math.max(0, Math.min(maxX, x)) + "px";
    dvd.style.top = Math.max(0, Math.min(maxY, y)) + "px";

    requestAnimationFrame(update);
}
</script>

</body>
</html>
